<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Data transformation | CO2 Emission Data Analysis</title>
  <meta name="description" content="Chapter 3 Data transformation | CO2 Emission Data Analysis" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Data transformation | CO2 Emission Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Data transformation | CO2 Emission Data Analysis" />
  
  
  

<meta name="author" content="Hanlin Yan, Yi Duan, Zining Chen" />


<meta name="date" content="2021-12-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-sources.html"/>
<link rel="next" href="missing-values.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">CO2DataAnalysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>2</b> Data sources</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-sources.html"><a href="data-sources.html#sampling-stations"><i class="fa fa-check"></i><b>2.1</b> Sampling stations</a></li>
<li class="chapter" data-level="2.2" data-path="data-sources.html"><a href="data-sources.html#co2-concentrations-categories"><i class="fa fa-check"></i><b>2.2</b> CO2 concentrations categories</a></li>
<li class="chapter" data-level="2.3" data-path="data-sources.html"><a href="data-sources.html#seawater-carbon-data"><i class="fa fa-check"></i><b>2.3</b> Seawater Carbon Data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>3</b> Data transformation</a></li>
<li class="chapter" data-level="4" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>4</b> Missing values</a></li>
<li class="chapter" data-level="5" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>5</b> Results</a>
<ul>
<li class="chapter" data-level="5.1" data-path="results.html"><a href="results.html#co2-changes-by-time"><i class="fa fa-check"></i><b>5.1</b> CO2 changes by time</a></li>
<li class="chapter" data-level="5.2" data-path="results.html"><a href="results.html#factors-affecting-the-co2-changes"><i class="fa fa-check"></i><b>5.2</b> Factors affecting the CO2 changes</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="results.html"><a href="results.html#locations-different-sampling-stations"><i class="fa fa-check"></i><b>5.2.1</b> locations: different sampling stations</a></li>
<li class="chapter" data-level="5.2.2" data-path="results.html"><a href="results.html#time-different-months"><i class="fa fa-check"></i><b>5.2.2</b> Time: different months</a></li>
<li class="chapter" data-level="5.2.3" data-path="results.html"><a href="results.html#sea-water-features"><i class="fa fa-check"></i><b>5.2.3</b> Sea water features</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="results.html"><a href="results.html#co2-changes-during-covid-19-pandemic"><i class="fa fa-check"></i><b>5.3</b> CO2 changes during Covid-19 pandemic</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interactive-component.html"><a href="interactive-component.html"><i class="fa fa-check"></i><b>6</b> Interactive component</a></li>
<li class="chapter" data-level="7" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>7</b> Conclusion</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CO2 Emission Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-transformation" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Data transformation</h1>
<p>First, let’s take a look at our raw data. Take alt as an example, it contains 10 columns. Columns 1-4 provide different formats of dates, so we keep only the year and month columns. Columns 5-10 are monthly CO2 concentrations in different versions that have been adjusted. We only use column 5 in this project because it is the most standard.</p>
<pre><code>##      Yr Mn Date.Excel     Date CO2..ppm. seasonally..adjusted fit..ppm.
## 13 2012  1      40923 2012.041    399.10               394.87    398.02
## 14 2012  2      40954 2012.126    398.83               393.60    399.20
## 15 2012  3      40983 2012.205    399.40               393.67    399.85
## 16 2012  4      41014 2012.290    400.07               394.39    400.00
## 17 2012  5      41044 2012.372    400.42               394.75    400.17
## 18 2012  6      41075 2012.456    397.28               394.51    397.47
## 19 2012  7      41105 2012.538    389.59               394.40    390.11
## 20 2012  8      41136 2012.623    382.70               393.96    383.90
## 21 2012  9      41167 2012.708    386.00               396.33    385.08
## 22 2012 10      41197 2012.790    390.42               395.60    390.49
##    seasonally.adjusted.fit..ppm. CO2.filled..ppm.
## 13                        393.79           399.10
## 14                        393.97           398.83
## 15                        394.13           399.40
## 16                        394.31           400.07
## 17                        394.50           400.42
## 18                        394.71           397.28
## 19                        394.92           389.59
## 20                        395.16           382.70
## 21                        395.41           386.00
## 22                        395.67           390.42
##    seasonally.adjusted.filled..ppm.
## 13                           394.87
## 14                           393.60
## 15                           393.67
## 16                           394.39
## 17                           394.75
## 18                           394.51
## 19                           394.40
## 20                           393.96
## 21                           396.33
## 22                           395.60</code></pre>
<p>So we select year, month, and CO2 ppm columns and rename the last column to the station name because we have C02 concentration data for different stations and we need to separate them. This is what the dataset looks like after our selection.</p>
<pre><code>##      Yr Mn    alt
## 13 2012  1 399.10
## 14 2012  2 398.83
## 15 2012  3 399.40
## 16 2012  4 400.07
## 17 2012  5 400.42
## 18 2012  6 397.28
## 19 2012  7 389.59
## 20 2012  8 382.70
## 21 2012  9 386.00
## 22 2012 10 390.42</code></pre>
<p>Then we do the same thing for all the stations of different locations.</p>
<p>Next we do an outer join by year and month columns for all the stations, and we have formed the new dataset “monthly_flask_co2” so far.</p>
<pre><code>##       Yr Mn    alt    mlo    kum    chr    sam    ker    nzd
## 625 2012  1 399.10 393.19 393.72    NaN 391.60    NaN 388.43
## 626 2012  2 398.83 393.47 395.39 393.53 392.08    NaN 388.10
## 627 2012  3 399.40 394.42 397.81 394.19 391.98 390.66 388.50
## 628 2012  4 400.07 396.48 397.72 393.61 391.66    NaN 388.50
## 629 2012  5 400.42 397.17 398.15 393.20 391.51    NaN 389.30
## 630 2012  6 397.28 396.11 396.28 393.73 391.66    NaN 390.57
## 631 2012  7 389.59 394.38 392.81    NaN 390.74 390.36    NaN
## 632 2012  8 382.70 392.02 392.54 392.78 392.07    NaN 390.81
## 633 2012  9 386.00 391.16 390.40    NaN 391.83 390.93 391.55
## 634 2012 10 390.42 391.08 391.67 394.65 392.17 391.69    NaN</code></pre>
<p>Since we don’t have categorical variables in our data, we want to add two categorical variables. Firstly, we change the numerical value of months to categories, such as January and February. Secondly, we separate our stations into two categories, in the northern hemisphere and in the southern hemisphere. Here is our data “monthly_co2_c”.</p>
<pre><code>## # A tibble: 110 × 5
##       Yr Mn    station CO2_concentration hemisphere
##    &lt;int&gt; &lt;chr&gt; &lt;chr&gt;               &lt;dbl&gt; &lt;chr&gt;     
##  1  2012 Jan   alt                  399. southern  
##  2  2012 Jan   mlo                  393. southern  
##  3  2012 Jan   kum                  394. southern  
##  4  2012 Jan   chr                  NaN  southern  
##  5  2012 Jan   sam                  392. southern  
##  6  2012 Jan   ker                  NaN  southern  
##  7  2012 Jan   nzd                  388. southern  
##  8  2012 Feb   alt                  399. southern  
##  9  2012 Feb   mlo                  393. southern  
## 10  2012 Feb   kum                  395. southern  
## # … with 100 more rows</code></pre>
<p>Since one of our goals is to study the impact of COVID-19 on CO2 concentrations, we need to filter the date during COVID-19, which is from March 2020 to now. Here is our data “covid_co2”.</p>
<pre><code>## # A tibble: 10 × 4
##       Yr    Mn station CO2_concentration
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;               &lt;dbl&gt;
##  1  2020     3 alt                  419.
##  2  2020     3 mlo                  414.
##  3  2020     3 kum                  416.
##  4  2020     3 chr                  NaN 
##  5  2020     3 sam                  412.
##  6  2020     3 ker                  409 
##  7  2020     3 nzd                  408.
##  8  2020     4 alt                  420.
##  9  2020     4 mlo                  416.
## 10  2020     4 kum                  417.</code></pre>
<p>In addition, we want to get the yearly CO2 concentrations for all the stations. So we aggregate station columns and get the average of all the months. After we tidy the data, we finally get our transformed data “yearly_co2”.</p>
<pre><code>## # A tibble: 10 × 3
##       Yr station CO2_concentration
##    &lt;int&gt; &lt;chr&gt;               &lt;dbl&gt;
##  1  2012 alt                  395.
##  2  2012 mlo                  394.
##  3  2012 kum                  395.
##  4  2012 chr                  394.
##  5  2012 sam                  392.
##  6  2012 ker                  391.
##  7  2012 nzd                  390.
##  8  2013 alt                  397.
##  9  2013 mlo                  397.
## 10  2013 kum                  397.</code></pre>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-sources.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="missing-values.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yhlpkucu/CO2DataAnalysis/edit/main/03-cleaning.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/yhlpkucu/CO2DataAnalysis/blob/main/03-cleaning.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
