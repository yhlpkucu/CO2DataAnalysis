<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Data transformation | CO2 Emission Data Analysis</title>
  <meta name="description" content="Chapter 3 Data transformation | CO2 Emission Data Analysis" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Data transformation | CO2 Emission Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Data transformation | CO2 Emission Data Analysis" />
  
  
  

<meta name="author" content="Hanlin Yan, Yi Duan, Zining Chen" />


<meta name="date" content="2021-12-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-sources.html"/>
<link rel="next" href="missing-values.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">CO2DataAnalysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>2</b> Data sources</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-sources.html"><a href="data-sources.html#monthly-average-co2-concentrations"><i class="fa fa-check"></i><b>2.1</b> Monthly average CO2 concentrations</a></li>
<li class="chapter" data-level="2.2" data-path="data-sources.html"><a href="data-sources.html#seawater-carbon-data"><i class="fa fa-check"></i><b>2.2</b> Seawater Carbon Data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>3</b> Data transformation</a></li>
<li class="chapter" data-level="4" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>4</b> Missing values</a></li>
<li class="chapter" data-level="5" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>5</b> Results</a></li>
<li class="chapter" data-level="6" data-path="interactive-component.html"><a href="interactive-component.html"><i class="fa fa-check"></i><b>6</b> Interactive component</a></li>
<li class="chapter" data-level="7" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>7</b> Conclusion</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CO2 Emission Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-transformation" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Data transformation</h1>
<p>First, let’s take a look at our raw data. Take alt as an example, it contains 10 columns. Columns 1-4 provide different formats of dates, so we keep only the year and month columns. Columns 5-10 are monthly CO2 concentrations in different versions that have been adjusted. We only use column 5 in this project because it is the most standard.</p>
<pre><code>##      Yr Mn Date.Excel     Date CO2..ppm. seasonally..adjusted fit..ppm.
## 1  2011  1      40558 2011.041       NaN                  NaN    395.66
## 2  2011  2      40589 2011.126       NaN                  NaN    396.87
## 3  2011  3      40617 2011.203       NaN                  NaN    397.54
## 4  2011  4      40648 2011.288       NaN                  NaN    397.70
## 5  2011  5      40678 2011.370       NaN                  NaN    397.90
## 6  2011  6      40709 2011.455       NaN                  NaN    395.29
## 7  2011  7      40739 2011.537       NaN                  NaN    387.95
## 8  2011  8      40770 2011.622       NaN                  NaN    381.62
## 9  2011  9      40801 2011.707    381.93               392.29    382.68
## 10 2011 10      40831 2011.789    388.07               393.28    388.02
##    seasonally.adjusted.fit..ppm. CO2.filled..ppm.
## 1                         391.44           395.66
## 2                         391.64           396.87
## 3                         391.82           397.54
## 4                         392.03           397.70
## 5                         392.23           397.90
## 6                         392.43           395.29
## 7                         392.63           387.95
## 8                         392.83           381.62
## 9                         393.04           381.93
## 10                        393.23           388.07
##    seasonally.adjusted.filled..ppm.
## 1                            391.44
## 2                            391.64
## 3                            391.82
## 4                            392.03
## 5                            392.23
## 6                            392.43
## 7                            392.63
## 8                            392.83
## 9                            392.29
## 10                           393.28</code></pre>
<p>So we select year, month, and CO2 ppm columns and rename the last column to the station name because we have C02 concentration data for different stations and we need to separate them. This is what the dataset looks like after our selection.</p>
<pre><code>##      Yr Mn    alt
## 1  2011  1    NaN
## 2  2011  2    NaN
## 3  2011  3    NaN
## 4  2011  4    NaN
## 5  2011  5    NaN
## 6  2011  6    NaN
## 7  2011  7    NaN
## 8  2011  8    NaN
## 9  2011  9 381.93
## 10 2011 10 388.07</code></pre>
<p>Then we do the same thing for all the stations of different locations.</p>
<p>Next we do an outer join by year and month columns for all the stations, and we have formed the new dataset “monthly_flask_co2” so far.</p>
<pre><code>##       Yr Mn    alt    mlo    kum    chr    sam    ker    nzd
## 613 2011  1    NaN 391.74 392.80 390.28 389.66 389.63 387.13
## 614 2011  2    NaN 391.69 393.71 391.43 389.02    NaN    NaN
## 615 2011  3    NaN 392.22 394.02 390.79 389.36    NaN 386.41
## 616 2011  4    NaN 393.74 396.27 391.87 388.13 387.95 388.58
## 617 2011  5    NaN 394.75 395.67 391.68 389.56    NaN    NaN
## 618 2011  6    NaN 393.54 394.41    NaN 389.00    NaN    NaN
## 619 2011  7    NaN 392.59 390.82 392.10 389.20 390.00 388.36
## 620 2011  8    NaN 390.20 388.18 391.02 390.10    NaN    NaN
## 621 2011  9 381.93 388.59 387.16 390.83    NaN    NaN 389.45
## 622 2011 10 388.07 389.26 389.98 390.46 390.37    NaN 387.99</code></pre>
<p>Since one of our goals is to study the impact of COVID-19 on CO2 concentrations, we need to filter the date during COVID-19, which is from March 2020 to now. Here is our data “covid_co2”.</p>
<pre><code>## # A tibble: 10 × 4
##       Yr    Mn station CO2_concentration
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;               &lt;dbl&gt;
##  1  2020     3 alt                  419.
##  2  2020     3 mlo                  414.
##  3  2020     3 kum                  416.
##  4  2020     3 chr                  NaN 
##  5  2020     3 sam                  412.
##  6  2020     3 ker                  409 
##  7  2020     3 nzd                  408.
##  8  2020     4 alt                  420.
##  9  2020     4 mlo                  416.
## 10  2020     4 kum                  417.</code></pre>
<p>In addition, we want to get the yearly CO2 concentrations for all the stations. So we aggregate station columns and get the sum by each year. After we tidy the data, we finally get our transformed data “yearly_co2”.</p>
<pre><code>## # A tibble: 10 × 3
##       Yr station CO2_concentration
##    &lt;int&gt; &lt;chr&gt;               &lt;dbl&gt;
##  1  2010 alt                   NA 
##  2  2010 mlo                 4677.
##  3  2010 kum                 4681.
##  4  2010 chr                 3111.
##  5  2010 sam                 3490.
##  6  2010 ker                 2323.
##  7  2010 nzd                 2704.
##  8  2011 alt                 1560.
##  9  2011 mlo                 4701.
## 10  2011 kum                 4709.</code></pre>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-sources.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="missing-values.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yhlpkucu/CO2DataAnalysis/edit/main/03-cleaning.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/yhlpkucu/CO2DataAnalysis/blob/main/03-cleaning.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
